#+TITLE:  CentosVZAdapter
#+PROPERTY: session *scratch*
#+PROPERTY: results output
#+PROPERTY: exports code
#+SETUPFILE: org-templates/level-0.org
#+options: ^:nil

* Introduction
This documents describes the implemetation of Auto Deployment Service
(ADS) using ansible software. Ansible playbook brings up the
CentosVZAdapter to run the Autodeployment services.

* Implementation
** Structure of the scripts
Scripts are organized as follows:
#+BEGIN_EXAMPLE
    |-- ansible_ads
    |   |-- files
    |   |    `-- clone_ads.sh
    |   |-- handlers
    |   |    `-- main.yml
    |   |-- meta
    |   |   `-- main.yml
    |   |-- tasks
    |   |   |-- main.yml
    |   |   `-- setup_ads.yml
#+END_EXAMPLE

** Get the sources
This command downloads the sources from github and extracts it.
#+BEGIN_SRC shell :tangle roles/ansible_ads/files/clone_ads.sh
#!/bin/bash
wget https://github.com/vlead/setup-ovpl-centos/archive/master.zip
unzip master.zip
#+END_SRC 

** Run the shell script to clone ADS
#+BEGIN_SRC yaml :tangle roles/ansible_ads/tasks/setup_ads.yml
---
  - name: run the shell script to clone ads
    script: clone_ads.sh
    environment: proxy_env
#+END_SRC 

#+BEGIN_SRC yaml :tangle roles/ansible_ads/meta/main.yml
---
dependencies:
  - role: common_vars
#+END_SRC


#+BEGIN_SRC yaml :tangle roles/ansible_ads/handlers/main.yml
---
#Empty
#+END_SRC

#+BEGIN_SRC yaml :tangle roles/ansible_ads/tasks/main.yml
---
 - name: cloning ads
   include: setup_ads.yml
#+END_SRC

